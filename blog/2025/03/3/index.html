<!doctype html>
<html lang="en" dir="ltr" class="blog-wrapper blog-post-page plugin-blog plugin-id-default" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.7.0">
<title data-rh="true">Wring simple parser with Megaparsec in Haskell | DG</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://your-docusaurus-site.example.com/img/docusaurus-social-card.jpg"><meta data-rh="true" name="twitter:image" content="https://your-docusaurus-site.example.com/img/docusaurus-social-card.jpg"><meta data-rh="true" property="og:url" content="https://your-docusaurus-site.example.com/blog/2025/03/3/"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docusaurus_tag" content="default"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docsearch:docusaurus_tag" content="default"><meta data-rh="true" property="og:title" content="Wring simple parser with Megaparsec in Haskell | DG"><meta data-rh="true" name="description" content="There goes around opinion that pure functional languages are rock solid and well suited for critical systems."><meta data-rh="true" property="og:description" content="There goes around opinion that pure functional languages are rock solid and well suited for critical systems."><meta data-rh="true" property="og:type" content="article"><meta data-rh="true" property="article:published_time" content="2025-03-03T00:00:00.000Z"><meta data-rh="true" property="article:tag" content="haskell,parsing,programming"><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://your-docusaurus-site.example.com/blog/2025/03/3/"><link data-rh="true" rel="alternate" href="https://your-docusaurus-site.example.com/blog/2025/03/3/" hreflang="en"><link data-rh="true" rel="alternate" href="https://your-docusaurus-site.example.com/blog/2025/03/3/" hreflang="x-default"><script data-rh="true" type="application/ld+json">{"@context":"https://schema.org","@type":"BlogPosting","@id":"https://your-docusaurus-site.example.com/blog/2025/03/3/","mainEntityOfPage":"https://your-docusaurus-site.example.com/blog/2025/03/3/","url":"https://your-docusaurus-site.example.com/blog/2025/03/3/","headline":"Wring simple parser with Megaparsec in Haskell","name":"Wring simple parser with Megaparsec in Haskell","description":"There goes around opinion that pure functional languages are rock solid and well suited for critical systems.","datePublished":"2025-03-03T00:00:00.000Z","author":[],"keywords":[],"isPartOf":{"@type":"Blog","@id":"https://your-docusaurus-site.example.com/blog","name":"Blog"}}</script><link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="DG RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="DG Atom Feed"><link rel="stylesheet" href="/assets/css/styles.06b657aa.css">
<script src="/assets/js/runtime~main.345a3317.js" defer="defer"></script>
<script src="/assets/js/main.b439d6ff.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();t(null!==e?e:"light")}(),function(){try{const n=new URLSearchParams(window.location.search).entries();for(var[t,e]of n)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><a class="navbar__brand" href="/"></a></div><div class="navbar__items navbar__items--right"><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite" aria-pressed="false"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="container margin-vert--lg"><div class="row"><aside class="col col--3"><nav class="sidebar_re4s thin-scrollbar" aria-label="Blog recent posts navigation"><div class="sidebarItemTitle_pO2u margin-bottom--md">Recent posts</div><div role="group"><h3 class="yearGroupHeading_rMGB">2025</h3><ul class="sidebarItemList_Yudw clean-list"><li class="sidebarItem__DBe"><a aria-current="page" class="sidebarItemLink_mo7H sidebarItemLinkActive_I1ZP" href="/blog/2025/03/3/">Wring simple parser with Megaparsec in Haskell</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/2025/01/18/">Introducing concurrency solver</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/2025/01/10/">My exploration of WASM/WASI</a></li></ul></div><div role="group"><h3 class="yearGroupHeading_rMGB">2024</h3><ul class="sidebarItemList_Yudw clean-list"><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/2024/12/29/">Christmas with Quantum Mechanics</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/2024/12/15/">Thoughts on observability</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/2024/11/5/">Reflections after writing simple Spring Boot library</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/2024/10/29/">1BRC Challenge</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/2024/10/26/">Topology graphs are important (and fun)</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/2024/10/4/">Writing own Kubernetes operator in Java</a></li></ul></div></nav></aside><main class="col col--7"><article class=""><header><h1 class="title_f1Hy">Wring simple parser with Megaparsec in Haskell</h1><div class="container_mt6G margin-vert--md"><time datetime="2025-03-03T00:00:00.000Z">March 3, 2025</time> · <!-- -->11 min read</div></header><div id="__blog-post-container" class="markdown"><p>There goes around opinion that pure functional languages are rock solid and well suited for critical systems.
For example Facebook uses it in anti-spam filters, serval financial companies for derivative modelling
and there is also some documented usage in compilers.</p>
<p>I tiptoed in Haskell long time ago, but didn&#x27;t really get it. This time, my particular usecase was that I wanted to have parser for
toy language with minimal effort. Parser combinators like Parsec or Megaparsec are known for purely declarative approach
to modelling grammars.</p>
<p>After 2 weeks of playing with the language I must say that there is something strangely addictive in writing pure functional
code. Reading it is hard, writing it even harder, but when it starts to work there is a lot of satisfaction. I don&#x27;t know
maybe I wasn&#x27;t feeling confident about it before, but I finally started to like it.</p>
<p>In this short writing we are going to write simple application that reads in json, validates it and then pretty prints to
the console. I used Megaparsec because its newer and has better error messages, but 99% could be written in parsec as well.
On the fly I will showcase some Haskell idioms I learned on the way.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="normal-workflow">Normal workflow<a href="#normal-workflow" class="hash-link" aria-label="Direct link to Normal workflow" title="Direct link to Normal workflow">​</a></h2>
<p>In haskell every function is a pure function, which means it&#x27;s idepotent. Side effects like IO are nicely contained in scope in
monads. What you get is that because there is no mutable state all the work is really composition of functions. It&#x27;s a little bit
intellectually demanding, but once you wrote it right, it&#x27;s hard to see it failing.</p>
<p>Most of the testing happens in REPL. Once you set up Stack or Cabal project you write functions in library module and the load it in REPL and
test the functions.</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">stack ghci</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ghci&gt; </span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>From there you can use various tools but most helpful is probably checking types of the functions.</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">ghci&gt; import Data.List</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ghci&gt; :t concat</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">concat :: Foldable t =&gt; t [a] -&gt; [a]</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Then you can test the function directly in REPL</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">ghci&gt; concat [&quot;Hello&quot;, &quot; &quot;, &quot;World&quot;]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&quot;Hello World&quot;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>There are 2 things at play here in this example:</p>
<ul>
<li>haskell has parameteric polymorphism, which means you can have some abstract type a (like generics)</li>
<li>string is actually list of char [Char]</li>
</ul>
<p>If you are stubborn you can of course write tests in HUnit, but since you can test it in REPL I don&#x27;t think
anyone writes them. But several libraries exist like HUnit.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="representing-data">Representing data<a href="#representing-data" class="hash-link" aria-label="Direct link to Representing data" title="Direct link to Representing data">​</a></h2>
<p>Haskell has no oop concepts so everthing is represented as Algebraic Data Types (or Generalized Algebraic Data Types for more power).
ADTs have two flavors:</p>
<ul>
<li>Sum types A or B</li>
<li>Product types tuples (A, B)</li>
</ul>
<p>This is how I represented internal JSON structure</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">data VNumber = VInt Integer |  VDouble Double</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    deriving (Show, Eq)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">data VJson =</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    VNumber VNumber</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    | VString String</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    | VBool Bool</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    | VNull</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    | VArray [VJson]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    | VObject [(String, VJson)]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    deriving (Show, Eq)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>VJSON is sum type of couple of variants. It think it&#x27;s self explanatory, except the deriving part. Since we are building on
top of built in types like Integer, Double and String, typeclass Show (printing to console) and Eq can be autogenerated. Typeclasses
for now are like constraints on wildcard generic types the expose some behaviour.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="parser">Parser<a href="#parser" class="hash-link" aria-label="Direct link to Parser" title="Direct link to Parser">​</a></h2>
<p>All parsing happens inside monad Parsec.</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Parsec e s a </span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>where
e - custom exception,</p>
<p>s - stream type, can be String, Text, or ByteString,</p>
<p>a returned structure.</p>
<p>so for this simple parser I created type alias</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">type Parser = Parsec Void String</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>You may notice the last type on the rhs is not defined so it &quot;floats&quot; to the definition on the left.</p>
<p>The flow is that you compose the smaller parsers into bigger parsers up to the top and the run topmmost one
with function parse</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">ghci&gt; :t parse</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">parse</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  :: Parsec e s a -&gt; String -&gt; s -&gt; Either (ParseErrorBundle s e) a</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>So it takes our parser, debugging message, text to parse and returns either Left error or Right result.</p>
<p>For now let&#x27;s see how the main function looks like:</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">run :: IO ()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">run  = do </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    args &lt;- getArgs</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    case args of </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        [filePath] -&gt; do </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            content &lt;- readFile filePath</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            let parseResult = parse value &quot;&quot; content </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            case parseResult of </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                Left err -&gt; putStr $ errorBundlePretty err </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                Right v -&gt; putStr $ prettyJson v 0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        _ -&gt; putStr &quot;Usage: program &lt;filepath&gt; \n&quot;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Pattern matching is easy to guess but for people unfamiliar with monads I will draw an analogy
for do notation in Java. So you have a method to that for each element returns a stream</p>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Stream&lt;Integer&gt; foo(Integer i) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    return Stream.of(i, i+1);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>And then you have a stream of 2 elements.</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Stream nums = Stream.of(1,3)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>And finally you may recall that there is a method flatMap, so combining everthing together</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Stream.of(1,3).flatMap(this::foo) // == Stream.of(1,2,3,4)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>So this is much like working with monads. The foo method works on extracted value from the previous monad
and returns back new monad. This particular monad has intrisinc behavior so it flattens the nested streams
but the behavior itself could be anyting you want it to be. You can chain multiple foos
and in the end you will get back monad.</p>
<p>So do notation is much alike that it allows to chain previous monadic function to the next.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="parser-rules">Parser rules<a href="#parser-rules" class="hash-link" aria-label="Direct link to Parser rules" title="Direct link to Parser rules">​</a></h2>
<p>Let&#x27;s start by parsing trivial cases of true, false and null.</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">literal :: Parser VJson</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">literal = do</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    lit &lt;- choice [C.string &quot;true&quot;, C.string &quot;false&quot;, C.string &quot;null&quot;]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         &lt;?&gt; &quot;only &#x27;true&#x27;, &#x27;false&#x27; and &#x27;null&#x27; literals are valid&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    _ &lt;- notFollowedBy C.alphaNumChar &lt;?&gt; &quot;only &#x27;true&#x27;, &#x27;false&#x27; and &#x27;null&#x27; literals are valid&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    if lit == &quot;true&quot; then</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        return $ VBool True</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    else if lit == &quot;false&quot; then</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        return $ VBool False</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    else</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        return VNull</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>From the first parts:</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">C.string &quot;true&quot;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>returns a parser that takes up &quot;true&quot; from the input or fails if not met.</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">choice [string &quot;a&quot;, string &quot;b&quot;]</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>returns composite parser that if string &quot;a&quot; fails then follows to the next parser up to exhaustion.</p>
<p>Then we save result in variable.</p>
<p><code>&lt;?&gt;</code>  allows for customizing failure message if the whole rule fails. It&#x27;s like returning parser monad that always
fails with this message.</p>
<p>Finally we make sure that literals have no trailers which allows us to fail exactly in this place not in some time later.</p>
<p>One of the monad methods is return which just wraps a value in the monad</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">return $ VBool False</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>The <code>$</code> means evaluate what is on the right side and apply it to left side. It&#x27;s needed here because evaluation happens from left to right.</p>
<p>Next</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">stringLiteral :: Parser VJson</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">stringLiteral = do</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    _ &lt;- C.char &#x27;&quot;&#x27;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    content &lt;- many (chunk &quot;\\\&quot;&quot; &lt;|&gt; (:[]) &lt;$&gt; anySingleBut &#x27;&quot;&#x27;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    _ &lt;- C.char &#x27;&quot;&#x27;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    return $ VString (concat content)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>First match &#x27;&quot;&#x27; single character then take zero or more parts that</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">chunk &quot;\\\&quot;&quot; &lt;|&gt; (:[]) &lt;$&gt; anySingleBut &#x27;&quot;&#x27;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Matches 2 chars \ and &quot; if that fails try parsing any char that is not &quot;.</p>
<p>One word of explanation for <code>&lt;$&gt;</code>. This operator takes a function (conversion to list or appending empty list afterwards)
and applies it inside the monad resulting in new monad with the result from function.</p>
<p>The most hard is parsing number</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">zero :: Parser String</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">zero = C.string &quot;0&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">digitFromOne :: Parser Char</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">digitFromOne = oneOf [&#x27;1&#x27;..&#x27;9&#x27;]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">wholePart :: Parser String</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">wholePart = choice [</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    zero,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     ((++) . (: []) &lt;$&gt; digitFromOne) &lt;*&gt; many C.digitChar]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">fractPart :: Parser String</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">fractPart  = do</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    dot &lt;- C.char &#x27;.&#x27;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    fract &lt;- some C.digitChar</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    return $ dot : fract</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">expPart  :: Parser String</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">expPart = do</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    e &lt;- oneOf [&#x27;E&#x27;, &#x27;e&#x27;]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    sign &lt;- option &quot;&quot; ((:[]) &lt;$&gt; oneOf [&#x27;+&#x27;, &#x27;-&#x27;])</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    num &lt;- some C.digitChar</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    return $ e : (sign ++ num)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">number :: Parser VJson</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">number = do</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    sign &lt;- option &quot;&quot; ((:[]) &lt;$&gt; oneOf [&#x27;+&#x27;, &#x27;-&#x27;])</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    wh &lt;- wholePart &lt;?&gt; &quot;whole part of number&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    fract &lt;- option &quot;&quot; fractPart</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    e &lt;- option &quot;&quot; expPart</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    if null fract  &amp;&amp; null e then</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        return $ VNumber (VInt $ read (sign ++ wh))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    else</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        return $ VNumber (VDouble $ read (sign ++ wh ++ fract ++ e))</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Explanations:</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">((++) . (: []) &lt;$&gt; digitFromOne) &lt;*&gt; many C.digitChar]</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>First convert char to String (with single char) inside monad. Then take this result and concat it with string
parsed by <code>many</code>.</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">ghci&gt; :t option</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">option :: GHC.Base.Alternative m =&gt; a -&gt; m a -&gt; m a</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>So option takes a default value, and a monad return new monad with possibly default applied.</p>
<p>So for example what this does</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">e &lt;- option &quot;&quot; expPart</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>is that if <code>expPart</code> matches it returns string otherwise empty string &quot;&quot; is assigned.</p>
<p>Then array value</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">array :: Parser VJson</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">array = do</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    _ &lt;- C.char &#x27;[&#x27;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    arr &lt;- value `sepBy` C.char &#x27;,&#x27;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    _ &lt;- C.char &#x27;]&#x27;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    return $ VArray arr</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>And object</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">keyValuePair :: Parser (String, VJson)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">keyValuePair = do</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    C.space</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    VString key &lt;- stringLiteral</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    C.space</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    _ &lt;- C.char &#x27;:&#x27;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    v &lt;- value</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    return (key, v)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">object :: Parser VJson</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">object = do</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    _ &lt;- C.char &#x27;{&#x27;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    kvs &lt;- keyValuePair `sepBy` C.char &#x27;,&#x27;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    _ &lt;- C.char &#x27;}&#x27;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    return $ VObject kvs</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Now that we have all the rules it is time to combine them</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">value :: Parser VJson</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">value = do</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    C.space</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    v &lt;- try literal &lt;|&gt; try stringLiteral &lt;|&gt; try number &lt;|&gt; try array &lt;|&gt; object</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    C.space</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    return v</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><code>try</code> tries parsing rule without consuming the input, note the last alternative is without try
to guarantee progress. It is a nice trick to consume spaces before and after proper value.</p>
<p>Megaparsec include test method parseTest. Let&#x27;s try it:</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">ghci&gt; parseTest value &quot;{\&quot;a\&quot; : 1, \&quot;b\&quot; : [1.0, 2.0]}&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">VObject [(&quot;a&quot;,VNumber (VInt 1)),(&quot;b&quot;,VArray [VNumber (VDouble 1.0),VNumber (VDouble 2.0)])]</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="printing">Printing<a href="#printing" class="hash-link" aria-label="Direct link to Printing" title="Direct link to Printing">​</a></h2>
<p>Some branches are easy but some are complicated:</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">prettyJson :: VJson -&gt; Int -&gt; String</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">prettyJson VNull _ = &quot;null&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">prettyJson (VBool True) _ = &quot;true&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">prettyJson (VBool False) _ = &quot;false&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">prettyJson (VNumber (VInt i)) _ = show i</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">prettyJson (VString s) _ = &quot;\&quot;&quot; ++ s ++ &quot;\&quot;&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">prettyJson (VNumber (VDouble d)) _ = show d</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">prettyJson (VArray arr) ind = &quot;[&quot; ++ printElems arr (ind+2) ++ &quot;\n&quot; ++ indent ind &quot;]\n&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    where </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        printElems (a:as) i = foldl </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            (\acc x -&gt; acc ++ &quot;,\n&quot; ++ indent i &quot;&quot; ++ prettyJson x i) (&quot;\n&quot; ++ indent i &quot;&quot; ++ prettyJson a i) as</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        printElems [] _ = &quot;&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        indent i s = replicate i &#x27; &#x27; ++ s</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">prettyJson (VObject arr) ind = &quot;{&quot; ++ printElems arr (ind+2) ++ &quot;\n&quot; ++ indent ind &quot;}\n&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    where </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        printElems ((k, v):as) i = foldl </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            (\acc (k2, v2) -&gt; acc ++ &quot;,\n&quot; ++ indent i &quot;&quot; ++ &quot;\&quot;&quot; ++ k2 ++ &quot;\&quot; : &quot; ++ prettyJson v2 i) </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            (&quot;\n&quot; ++ indent i &quot;&quot; ++ &quot;\&quot;&quot; ++ k ++ &quot;\&quot; : &quot; ++ prettyJson v i) </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            as</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        printElems [] _ = &quot;&quot;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Let&#x27;s only concentrate on VArray branch</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">prettyJson (VArray arr) ind = &quot;[&quot; ++ printElems arr (ind+2) ++ &quot;\n&quot; ++ indent ind &quot;]\n&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    where </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        printElems (a:as) i = foldl </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            (\acc x -&gt; acc ++ &quot;,\n&quot; ++ indent i &quot;&quot; ++ prettyJson x i) (&quot;\n&quot; ++ indent i &quot;&quot; ++ prettyJson a i) as</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        printElems [] _ = &quot;&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        indent i s = replicate i &#x27; &#x27; ++ s</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><code>printElems</code> is a helper method that prints elements each in new and indented line. The whole trick was that to not include
&quot;,&quot; after last expression. So this is how i did it. First match a list with first element and the rest. Then use <code>foldl</code> to reduce
array of json values to one string. The starting value is the matched first element <code>a</code> and it&#x27;s different. Then reduction function takes
accumulator and appends next element with &quot;,&quot; prepended. And for empty array just return empty string. <code>indent</code> is a helper method that prefixes
the give string with number of spaces.</p>
<p>Let&#x27;s test:</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">ghci&gt; putStr $ prettyJson ( VArray [(VNumber (VInt 1)), (VNumber (VInt 2))]) 0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  1,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ghci&gt; </span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="conclusion">Conclusion<a href="#conclusion" class="hash-link" aria-label="Direct link to Conclusion" title="Direct link to Conclusion">​</a></h2>
<p>That&#x27;s it  for this simple tutorial. Here is a list of nice readings</p>
<ul>
<li><a href="https://markkarpov.com/tutorial/megaparsec.html#notfollowedby-and-lookahead" target="_blank" rel="noopener noreferrer">Megaparsec intermediate tutorial</a></li>
<li><a href="https://smunix.github.io/dev.stephendiehl.com/hask/index.html" target="_blank" rel="noopener noreferrer">What I whish I knew learning Haskell</a></li>
<li><a href="https://gitlab.haskell.org/ghc/ghc/-/wikis/reading-list" target="_blank" rel="noopener noreferrer">GHC reading list | advanced </a></li>
<li><a href="https://smunix.github.io/dev.stephendiehl.com/fun/index.html" target="_blank" rel="noopener noreferrer">Write you a haskell</a></li>
</ul>
<p>I had a lot of fun and eager for new challenges. If I have some spare time maybe I will write how to write System F typechecker
in Haskell.</p>
<p>Thanks for now.</p>
<p>PS Here is the <a href="https://github.com/vulture-dominiczek/haskell-json-parser" target="_blank" rel="noopener noreferrer">code</a>.</p></div><footer class="docusaurus-mt-lg"><div class="row margin-top--sm theme-blog-footer-edit-meta-row"><div class="col"><b>Tags:</b><ul class="tags_jXut padding--none margin-left--sm"><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/blog/tags/haskell">haskell</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/blog/tags/parsing">parsing</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/blog/tags/programming">programming</a></li></ul></div></div><div class="row margin-top--sm theme-blog-footer-edit-meta-row"><div class="col"><a href="https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/blog/2025-03-3.md" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_JAkA"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Blog post page navigation"><a class="pagination-nav__link pagination-nav__link--next" href="/blog/2025/01/18/"><div class="pagination-nav__sublabel">Older post</div><div class="pagination-nav__label">Introducing concurrency solver</div></a></nav></main><div class="col col--2"><div class="tableOfContents_bqdL thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#normal-workflow" class="table-of-contents__link toc-highlight">Normal workflow</a></li><li><a href="#representing-data" class="table-of-contents__link toc-highlight">Representing data</a></li><li><a href="#parser" class="table-of-contents__link toc-highlight">Parser</a></li><li><a href="#parser-rules" class="table-of-contents__link toc-highlight">Parser rules</a></li><li><a href="#printing" class="table-of-contents__link toc-highlight">Printing</a></li><li><a href="#conclusion" class="table-of-contents__link toc-highlight">Conclusion</a></li></ul></div></div></div></div></div><footer class="footer"><div class="container container-fluid"></div></footer></div>
</body>
</html>