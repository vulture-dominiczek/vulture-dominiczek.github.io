<!doctype html>
<html lang="en" dir="ltr" class="blog-wrapper blog-post-page plugin-blog plugin-id-default" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.7.0">
<title data-rh="true">Thoughts on observability | DG</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://your-docusaurus-site.example.com/img/docusaurus-social-card.jpg"><meta data-rh="true" name="twitter:image" content="https://your-docusaurus-site.example.com/img/docusaurus-social-card.jpg"><meta data-rh="true" property="og:url" content="https://your-docusaurus-site.example.com/blog/2024/12/15/"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docusaurus_tag" content="default"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docsearch:docusaurus_tag" content="default"><meta data-rh="true" property="og:title" content="Thoughts on observability | DG"><meta data-rh="true" name="description" content="Everything is complicated, even those things that seem flat in their bleakness."><meta data-rh="true" property="og:description" content="Everything is complicated, even those things that seem flat in their bleakness."><meta data-rh="true" property="og:type" content="article"><meta data-rh="true" property="article:published_time" content="2024-12-15T00:00:00.000Z"><meta data-rh="true" property="article:tag" content="systemdesign,cloud,kubernetes"><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://your-docusaurus-site.example.com/blog/2024/12/15/"><link data-rh="true" rel="alternate" href="https://your-docusaurus-site.example.com/blog/2024/12/15/" hreflang="en"><link data-rh="true" rel="alternate" href="https://your-docusaurus-site.example.com/blog/2024/12/15/" hreflang="x-default"><script data-rh="true" type="application/ld+json">{"@context":"https://schema.org","@type":"BlogPosting","@id":"https://your-docusaurus-site.example.com/blog/2024/12/15/","mainEntityOfPage":"https://your-docusaurus-site.example.com/blog/2024/12/15/","url":"https://your-docusaurus-site.example.com/blog/2024/12/15/","headline":"Thoughts on observability","name":"Thoughts on observability","description":"Everything is complicated, even those things that seem flat in their bleakness.","datePublished":"2024-12-15T00:00:00.000Z","author":[],"keywords":[],"isPartOf":{"@type":"Blog","@id":"https://your-docusaurus-site.example.com/blog","name":"Blog"}}</script><link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="DG RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="DG Atom Feed"><link rel="stylesheet" href="/assets/css/styles.06b657aa.css">
<script src="/assets/js/runtime~main.8488876f.js" defer="defer"></script>
<script src="/assets/js/main.b779d075.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();t(null!==e?e:"light")}(),function(){try{const n=new URLSearchParams(window.location.search).entries();for(var[t,e]of n)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><a class="navbar__brand" href="/"></a></div><div class="navbar__items navbar__items--right"><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite" aria-pressed="false"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="container margin-vert--lg"><div class="row"><aside class="col col--3"><nav class="sidebar_re4s thin-scrollbar" aria-label="Blog recent posts navigation"><div class="sidebarItemTitle_pO2u margin-bottom--md">Recent posts</div><div role="group"><h3 class="yearGroupHeading_rMGB">2025</h3><ul class="sidebarItemList_Yudw clean-list"><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/2025/03/9/">Semantic search for dynamically built queries in Java and CodeQL</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/2025/03/3/">Wring simple parser with Megaparsec in Haskell</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/2025/01/18/">Introducing concurrency solver</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/2025/01/10/">My exploration of WASM/WASI</a></li></ul></div><div role="group"><h3 class="yearGroupHeading_rMGB">2024</h3><ul class="sidebarItemList_Yudw clean-list"><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/2024/12/29/">Christmas with Quantum Mechanics</a></li><li class="sidebarItem__DBe"><a aria-current="page" class="sidebarItemLink_mo7H sidebarItemLinkActive_I1ZP" href="/blog/2024/12/15/">Thoughts on observability</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/2024/11/5/">Reflections after writing simple Spring Boot library</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/2024/10/29/">1BRC Challenge</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/2024/10/26/">Topology graphs are important (and fun)</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/2024/10/4/">Writing own Kubernetes operator in Java</a></li></ul></div></nav></aside><main class="col col--7"><article class=""><header><h1 class="title_f1Hy">Thoughts on observability</h1><div class="container_mt6G margin-vert--md"><time datetime="2024-12-15T00:00:00.000Z">December 15, 2024</time> · <!-- -->4 min read</div></header><div id="__blog-post-container" class="markdown"><p><em>Everything is complicated, even those things that seem flat in their bleakness.</em></p>
<p>Debugging microservices application based on scarce information is one of those cases that I don&#x27;t wish
anyone. But it is how it is at my current project, so management started to put some measures in motion.</p>
<p>I reaserched topic a bit at work and a bit on my own and I have something to share - <a href="https://opentelemetry.io/" target="_blank" rel="noopener noreferrer">OpenTelemetry is the future</a>. Bu it is still work in progress.</p>
<p>In this post I will tell you everything I learned.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="observability-intro">Observability intro<a href="#observability-intro" class="hash-link" aria-label="Direct link to Observability intro" title="Direct link to Observability intro">​</a></h2>
<p>When it comes to first (and most important) pillar of observability - logs, the first little revolution came with the invention of <strong>Mapped Diagnostic Context</strong>.  Neil Harrison described this method in the book <em>Patterns for Logging Diagnostic Messages in Pattern Languages of Program Design 3, edited by R. Martin, D. Riehle, and F. Buschmann (Addison-Wesley, 1997)</em>.</p>
<p>The beauty of the idea is it&#x27;s simplicity. You put collection of key value pairs in thread local storage and
implicitly append them to logs each time the log message is created. As you know ids, names and other stuff can &quot;span&quot; multiple nested method calls and this really makes life a little bit easier. Beacause it 2025 all logging framework support it, but that&#x27;s not all.</p>
<p>Taking it one step further you could propagate this key values across threads and (eventually) service boundaries. Welcome to distributed tracing. Spring Boot covers all this stuff semi-automatically all you have to do is to configure proper tools (Zipkin-Brave or OTEL).</p>
<p>And finally golden standard Prometheus scrapes at given metrics exported from your Spring app on given endpoint and acts as a store for Grafana to display.</p>
<p>These were the 3 components of Observability: Metrics, Logs and Traces.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="what-the-future-will-bring">What the future will bring<a href="#what-the-future-will-bring" class="hash-link" aria-label="Direct link to What the future will bring" title="Direct link to What the future will bring">​</a></h2>
<p>Not so long ago <strong>Open Telemetry</strong> emerged as a standard for application instrumentation with all 3 observability components. State of providers is quite good - 40+ languages covered more or less exporting to
various sinks like ELK stack, Grafana and Zipkin/Jaeger.</p>
<p>But to be honest I didn&#x27;t find any easy to use out of the box tool to visualize these goods. Yes there is Grafana with extensions for Loki (logs) and tempo db (traces) but the documentation has holes and you can&#x27;t just set everything in a day. Some Open Source dashboards exist to my knowledge but they are a little bit clunky to use and limited.</p>
<p>As usual complex stuff requires time and time is money. So I would look for the innovations in the commercial side of the topic. I even have my favourite <strong>Lighstep</strong> - now ServiceNow Cloud Observability is one such solution that can do it well. They market it as</p>
<ul>
<li>possible to go all between logs traces and metrics</li>
<li>use AI to diagnose problems (interesting)</li>
</ul>
<p>But I&#x27;m not an architect and not planning to put my own money on the table so this has stay in the land of dreams for now.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="how-i-done-poc">How I done POC<a href="#how-i-done-poc" class="hash-link" aria-label="Direct link to How I done POC" title="Direct link to How I done POC">​</a></h2>
<p>At work I tried to setup Spring to send traces to Zipkin as Proof of Concept and it costed me a little bit of effort. Because there are 2 bridges (adapters) and 2 exporters there is a little bit of problem - mix any of the 2 up and it will break. Oh how I wish it would just break with explicit error! Instead it just does not send logs and go figure why.</p>
<p>Luckily I started with OTEL first and when I switched I saw mixed jars so after exluding otel from parent pom i got finally traces to zipkin. The next step was to actually propagate the trace id across services boundaries. I discovered a cool feature - a <strong>baggage</strong>. It&#x27;s a key-value pairs collection that propagetes with traceId/spanId. If you set some config property (like remote-fields or something) you get it sent to other service for free.</p>
<p>As long as you use Spring stack to send requests the MDC gets exported as SimpleTextMap sent in a header.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="conclusion">Conclusion<a href="#conclusion" class="hash-link" aria-label="Direct link to Conclusion" title="Direct link to Conclusion">​</a></h2>
<p>Future is integration of all three pillars of observability.</p>
<p>In time there eventually be a Open Source solution that enables you to switch between logs traces and metrics from single place and it will be to much of everyones joy.</p>
<p>But for now waiting is all we can do.</p></div><footer class="docusaurus-mt-lg"><div class="row margin-top--sm theme-blog-footer-edit-meta-row"><div class="col"><b>Tags:</b><ul class="tags_jXut padding--none margin-left--sm"><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/blog/tags/systemdesign">systemdesign</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/blog/tags/cloud">cloud</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/blog/tags/kubernetes">kubernetes</a></li></ul></div></div><div class="row margin-top--sm theme-blog-footer-edit-meta-row"><div class="col"><a href="https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/blog/2024-12-15.md" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_JAkA"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Blog post page navigation"><a class="pagination-nav__link pagination-nav__link--prev" href="/blog/2024/12/29/"><div class="pagination-nav__sublabel">Newer post</div><div class="pagination-nav__label">Christmas with Quantum Mechanics</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/blog/2024/11/5/"><div class="pagination-nav__sublabel">Older post</div><div class="pagination-nav__label">Reflections after writing simple Spring Boot library</div></a></nav></main><div class="col col--2"><div class="tableOfContents_bqdL thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#observability-intro" class="table-of-contents__link toc-highlight">Observability intro</a></li><li><a href="#what-the-future-will-bring" class="table-of-contents__link toc-highlight">What the future will bring</a></li><li><a href="#how-i-done-poc" class="table-of-contents__link toc-highlight">How I done POC</a></li><li><a href="#conclusion" class="table-of-contents__link toc-highlight">Conclusion</a></li></ul></div></div></div></div></div><footer class="footer"><div class="container container-fluid"></div></footer></div>
</body>
</html>